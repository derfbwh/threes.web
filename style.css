body {
    font-family: 'Helvetica Neue', Arial, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
    background-color: #faf8ef;
    color: #776e65;
}

.game-container {
    width: 350px;
    display: flex;
    flex-direction: column;
}

.header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 20px;
}

.scores {
    display: flex;
    gap: 10px;
}

.score-container {
    background: #bbada0;
    padding: 5px 15px;
    border-radius: 6px;
    color: white;
    font-weight: bold;
    font-size: 13px;
    text-align: center;
    text-transform: uppercase;
}

.score-container span {
    display: block;
    font-size: 20px;
    margin-top: 2px;
}

.best-container {
    background: #8f7a66; /* Slightly darker to stand out */
}

h1 {
    margin: 0;
    font-size: 27px; /* Scaled down from 42px to fit the longer name */
    line-height: 1; /* Keeps the spacing tight against the Next indicator */
    letter-spacing: -1px; /* Pulls the characters slightly closer for a logo feel */
    color: #776e65;
}

/* Optional: Ensure dark mode also targets the header cleanly */
body.dark-mode h1 {
    color: #f9f6f2;
}

/* The grid now acts as a relative positioning anchor */
.grid {
    position: relative;
    width: 310px;  /* (4 * 65px) + (5 * 10px gap) */
    height: 410px; /* (4 * 90px) + (5 * 10px gap) */
    background: #c2d6d8;
    border-radius: 10px;
}

.grid-background {
    display: grid;
    grid-template-columns: repeat(4, 65px);
    grid-template-rows: repeat(4, 90px);
    gap: 10px;
    padding: 10px;
    position: absolute;
    top: 0; left: 0;
}

.cell-bg {
    background: rgba(255, 255, 255, 0.35);
    border-radius: 5px;
    width: 65px;
    height: 90px;
}

.tile-container {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    pointer-events: none;
}

/* Tiles are absolute and transition their transforms */
.tile {
    position: absolute;
    width: 65px;
    height: 90px;
    border-radius: 5px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 32px;
    font-weight: bold;
    /* This transition handles the sliding */
    transition: transform 0.15s ease-in-out, background-color 0.15s ease, color 0.15s ease;
}

.tile-1 { background-color: #66CCFF; color: white; }
.tile-2 { background-color: #FF6680; color: white; }
.tile-3plus { 
    background-color: #FFFFFF; 
    color: #333; 
    box-shadow: 0 4px 0 rgba(0,0,0,0.1); 
}

/* --- Game Over Screen Styles --- */
.game-over {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(238, 228, 218, 0.85); /* Semi-transparent overlay */
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 100;
    border-radius: 10px;
    opacity: 0;
    pointer-events: none; /* Let clicks pass through when hidden */
    transition: opacity 0.3s ease;
}

.game-over.show {
    opacity: 1;
    pointer-events: auto; /* Re-enable clicks when shown */
}

.game-over h2 {
    font-size: 36px;
    margin-bottom: 10px;
    color: #776e65;
}

.game-over button {
    margin-top: 20px;
    padding: 10px 20px;
    font-size: 18px;
    font-weight: bold;
    background-color: #f67c5f;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.2s;
}

.game-over button:hover {
    background-color: #ea593c;
}

/* --- Credits Styles --- */
.credits {
    margin-top: 30px;
    font-size: 13px;
    color: #a0978d; /* Blends nicely with the Threes palette */
    line-height: 1.2;
}

.credits i {
    margin-right: 4px; /* Give the icon a little breathing room */
    font-size: 14px;
    vertical-align: middle;
}

/* Ensure icons transition smoothly with the text color */
.credits a i {
    transition: color 0.2s;
}

.credits p {
    margin: 5px 0;
}

.credits a {
    color: #f67c5f; /* The orange/salmon accent color */
    text-decoration: none;
    font-weight: bold;
    transition: color 0.2s, text-decoration 0.2s;
}

.credits a:hover {
    color: #ea593c;
    text-decoration: underline;
}

/* --- Next Tile Indicator --- */
.title-container {
    display: flex;
    flex-direction: column;
}

.next-indicator {
    display: flex;
    align-items: center;
    font-size: 14px;
    font-weight: bold;
    color: #a0978d;
    margin-top: 5px;
    text-transform: uppercase;
}

.mini-tile {
    width: 25px;
    height: 35px;
    border-radius: 3px;
    margin-left: 10px;
    transition: background-color 0.2s ease, color 0.2s ease;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 18px;
    /* Removed the default #ccc background so the classes below can take over */
}

/* Explicitly style the mini-tiles to match the board */
.mini-tile.tile-1 {
    background-color: #66CCFF; /* Blue */
    color: white;
}

.mini-tile.tile-2 {
    background-color: #FF6680; /* Red */
    color: white;
}

.mini-tile.tile-3plus {
    background-color: #FFFFFF; /* White */
    color: #333;
    box-shadow: 0 2px 0 rgba(0,0,0,0.1); /* Slightly smaller shadow for the mini tile */
}

/* --- Theme Toggle Button --- */
/* --- Theme Toggle Button --- */
.theme-btn {
    margin-top: 10px;
    margin-bottom: 15px; /* Gives the credits some breathing room */
    padding: 5px 10px;
    font-size: 12px;
    background-color: transparent;
    color: inherit;
    border: 1px solid #bbada0;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
    transition: background-color 0.2s, color 0.2s;
    align-self: center; /* Keeps it neatly centered below the board */
}
.theme-btn:hover {
    background-color: #bbada0;
    color: white;
}

/* --- Dark Mode Overrides --- */
body.dark-mode {
    background-color: #1e1e1e;
    color: #f9f6f2;
}

body.dark-mode .grid {
    background: #3d4f51; /* Darker grey-blue */
}

body.dark-mode .cell-bg {
    background: rgba(0, 0, 0, 0.2);
}

body.dark-mode .tile-3plus,
body.dark-mode .mini-tile.tile-3plus {
    background-color: #2c2c2c;
    color: #f9f6f2;
    box-shadow: 0 4px 0 rgba(0, 0, 0, 0.3); /* Stronger shadow for dark mode */
}

body.dark-mode .mini-tile.tile-3plus {
    box-shadow: 0 2px 0 rgba(0, 0, 0, 0.3);
}

body.dark-mode .score-container {
    background: #5c544b;
}

body.dark-mode .best-container {
    background: #4a433c;
}

body.dark-mode .game-over {
    background: rgba(30, 30, 30, 0.85);
}

body.dark-mode .game-over h2 {
    color: #f9f6f2;
}

body.dark-mode .theme-btn {
    border-color: #5c544b;
}

body.dark-mode .theme-btn:hover {
    background-color: #5c544b;
}

body.dark-mode .mini-tile {
    border: 2px solid #3d4f51;
}

/* --- Dark Mode Colored Tile Adjustments --- */
/* Targets both main tiles and mini-tiles in dark mode */

body.dark-mode .tile-1,
body.dark-mode .mini-tile.tile-1 {
    /* A deeper, more muted cerulean blue */
    background-color: #3d8eb9; 
    /* Ensure text stays light (though it should already be white) */
    color: #f9f6f2; 
}

body.dark-mode .tile-2,
body.dark-mode .mini-tile.tile-2 {
    /* A deeper, more muted salmon red */
    background-color: #c75466; 
    color: #f9f6f2;
}

/* =========================================
   THE JUICE (Animations & Game Feel)
   ========================================= */

/* 1. The Invalid Move Bump (Applied to the whole grid) */
.grid {
    transition: transform 0.1s ease;
}

.grid.bump-ArrowLeft  { transform: translateX(-6px); }
.grid.bump-ArrowRight { transform: translateX(6px);  }
.grid.bump-ArrowUp    { transform: translateY(-6px); }
.grid.bump-ArrowDown  { transform: translateY(6px);  }

/* 2. Tile Scale Support */
.tile {
    /* We add the standalone scale property so we can animate it without breaking translate */
    scale: 1; 
    transition: transform 0.15s ease-in-out, background-color 0.15s ease, color 0.15s ease, scale 0.15s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

/* 3. Spawn Animation (Scaling up from 0) */
@keyframes pop-in {
    0%   { scale: 0.9; opacity: 0; } /* Fade in and slight scale instead of 0 */
    100% { scale: 1; opacity: 1; }
}

.tile.appear {
    animation: pop-in 0.15s ease-out forwards;
}

/* 4. Merge Celebration Pop */
.tile.pop {
    scale: 1.04;
    box-shadow: 0 8px 8px rgba(0,0,0,0.1); /* Extra shadow during the pop */
    z-index: 20; /* Ensure it pops over adjacent tiles */
}

/* 5. Score Increase Hop */
.score-container span {
    transition: scale 0.15s ease, color 0.15s ease;
    display: inline-block;
}

.score-container span.score-pop {
    scale: 1.1;
    color: #fff; /* Flashes bright white */
}

/* 6. Game Over Bounce Drop */
.game-over {
    opacity: 0;
    transform: translateY(-20px) scale(0.95);
    transition: opacity 0.4s ease, transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.game-over.show {
    opacity: 1;
    transform: translateY(0) scale(1);
}